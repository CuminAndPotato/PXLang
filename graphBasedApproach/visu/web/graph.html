<!DOCTYPE html>
<html>
<head>
    <title>Graph</title>

    <meta name="description" content="A family tree diagram of British royalty." />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        #myDiagramDiv {
            min-width: 90vh;
            min-height: 90vh;
            border: solid 1px black;
            background-color: white;
        }
    </style>

    <script src="go.js"></script>
    <script src="data.js"></script>

    <script id="code">
        function init() {
            var $ = go.GraphObject.make; // for conciseness in defining templates

            var getLayout = function() {
                if (window.layout === "graph") {
                    return $(go.ForceDirectedLayout);
                } else {
                    return $(go.TreeLayout,
                        {
                            angle: 90
                        });
                }
            }

            var myDiagram =
                $(go.Diagram,
                    "myDiagramDiv", // must be the ID or reference to div
                    {
                        layout: getLayout()
                    });

            var hideWhenEmpty = function(prop) {
                return new go.Binding("height",
                    prop,
                    function(x) {
                        if (x === "") return 0;
                        else return undefined;
                    });
            };

            myDiagram.nodeTemplate =
                $(go.Node, "Auto",
                    $(go.Shape,
                        {
                            fill: "white",
                            stroke: "darkblue",
                            strokeWidth: 2
                        },
                        new go.Binding("figure", "fig")),
                    $(go.Panel, "Table",
                        {
                            defaultAlignment: go.Spot.Left,
                            margin: 10
                        },
                        $(go.RowColumnDefinition,
                            {
                                column: 1,
                                width: 1
                            }),
                        $(go.TextBlock,
                            {
                                row: 0,
                                alignment: go.Spot.Center,
                                font: "bold 12pt sans-serif"
                            },
                            hideWhenEmpty("name"),
                            new go.Binding("text", "name")),
                        $(go.TextBlock,
                            {
                                row: 1,
                                font: "10pt Consolas",
                                spacingAbove: 2,
                                spacingBelow: 2
                            },
                            hideWhenEmpty("desc"),
                            new go.Binding("text", "desc"))
                    )
                );

            myDiagram.linkTemplate =
                $(go.Link, // the whole link panel
                    $(go.Shape), // the link shape
                    $(go.Shape, // the arrowhead
                        {
                            toArrow: "OpenTriangle",
                            fill: null
                        })
                );

            myDiagram.model = new go.GraphLinksModel(window.nodeDataArray, window.linkDataArray);

            window.myDiagram = myDiagram;
        }
    </script>
</head>
<body onload="init()">
    <div id="sample">
        <div id="myDiagramDiv"></div>
    </div>
</body>
</html>